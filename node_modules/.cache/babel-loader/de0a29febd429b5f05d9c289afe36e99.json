{"ast":null,"code":"import _toConsumableArray from\"/Users/meghangosselin/Apps/thinkfast/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/meghangosselin/Apps/thinkfast/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{Howl}from\"howler\";import\"../styles/EndGame.scss\";export default function EndGame(_ref){var setIsEnd=_ref.setIsEnd,playerMode=_ref.playerMode,setPlayerMode=_ref.setPlayerMode,nameForPlayer1=_ref.nameForPlayer1,nameForPlayer2=_ref.nameForPlayer2,player1Score=_ref.player1Score,setPlayer1Score=_ref.setPlayer1Score,player2Score=_ref.player2Score,setPlayer2Score=_ref.setPlayer2Score,highScores=_ref.highScores,setHighScores=_ref.setHighScores,getAndSetHighScores=_ref.getAndSetHighScores;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),isHighScore=_useState2[0],setIsHighScore=_useState2[1];// When true will notify of new high score\n// End of game sound\nvar trophy=new Howl({src:[\"audio/trophy.mp3\"],volume:0.3});var end=new Howl({src:[\"audio/game-end.mp3\"],volume:0.2});// API REQUEST FUNCTIONS\nvar eliminateScorerFromTopTen=function eliminateScorerFromTopTen(scorerId){axios.delete(\"https://thinkfast-api.herokuapp.com/scores/\".concat(scorerId)).then(function(response){console.log(\"\".concat(scorerId,\" has been deleted\"));}).catch(function(error){console.log(error);});};var postHighScoreToTopTen=function postHighScoreToTopTen(player){axios.post(\"https://thinkfast-api.herokuapp.com/scores\",{name:player.name,score:player.score,date:player.date}).then(function(response){console.log(\"High score posted for \".concat(player.name));getAndSetHighScores(setHighScores);}).catch(function(error){console.log(error);});};// FUNCTIONS DEALING WITH HIGH SCORES\n// If in 2-player mode and both score higher than the current 10th place score this will determine what scores will get posted and eliminated\nvar determineScoresToPost=function determineScoresToPost(p1,p2){var tempScores=highScores.slice();tempScores=[].concat(_toConsumableArray(tempScores),[p1,p2]);tempScores.sort(function(a,b){return b.score-a.score;});var topTen=tempScores.slice(0,10);var whoMadeTheTopTen=topTen.filter(function(score){return!score.hasOwnProperty(\"_id\");});setIsHighScore(_toConsumableArray(whoMadeTheTopTen));trophy.play();if(postScores(whoMadeTheTopTen)===2){console.log(\"Delete:\",tempScores[10],tempScores[11]);eliminateScorerFromTopTen(tempScores[10]._id);eliminateScorerFromTopTen(tempScores[11]._id);}else{console.log(\"Delete:\",tempScores[11]);eliminateScorerFromTopTen(tempScores[11]._id);}};var postScores=function postScores(scores){scores.forEach(function(score){postHighScoreToTopTen(score);});return scores.length;};/////////////////////////////////////////////////////////////////////////////////\nuseEffect(function(){// Play ending music\nend.play();// Get today's date and return as formatted string \"m/yy\"\nvar getTheDate=function getTheDate(){var today=new Date();var month=String(today.getMonth()+1);var year=String(today.getFullYear()).slice(-2);return\"\".concat(month,\"/\").concat(year);};// Create object for player 1\nvar p1={name:nameForPlayer1,score:player1Score,date:getTheDate()};// Create object for player 2\nvar p2={name:nameForPlayer2,score:player2Score,date:getTheDate()};// First, in a 2-player game, determine if both players score high enough to be in top 10.\n// Second, in either a single or 2-player game check if player 1 scored high enough.\n// Third, check if player 2 scored high enough\nif(playerMode===2&&player1Score>highScores[9].score&&player2Score>highScores[9].score){determineScoresToPost(p1,p2);}else if(player1Score>highScores[9].score){eliminateScorerFromTopTen(highScores[9]._id);postHighScoreToTopTen(p1);setIsHighScore([p1]);trophy.play();}else if(player2Score>highScores[9].score){eliminateScorerFromTopTen(highScores[9]._id);postHighScoreToTopTen(p2);setIsHighScore([p2]);trophy.play();}},[nameForPlayer1]);//////////////////////////////////////////////////////////////////\nvar restart=function restart(){setIsEnd(false);setPlayer1Score(0);setPlayer2Score(0);setIsHighScore([]);setPlayerMode(null);};// MESSAGING FOR END OF GAME (DEPENDS ON PLAYER MODE AND PLAYER'S SCORE)\nvar endOfGameMessage;// 1 Player Mode\nif(playerMode===1&&player1Score<0){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"You are such a negative person!\"),/*#__PURE__*/React.createElement(\"p\",null,\"You scored \".concat(player1Score,\" points.\")));}if(playerMode===1&&player1Score===0){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"You thought you were a hero, but then got zero!\"),/*#__PURE__*/React.createElement(\"p\",null,\"You scored \".concat(player1Score,\" points.\")));}if(playerMode===1&&player1Score>0&&player1Score<=25){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"You need a lot more practice!\"),/*#__PURE__*/React.createElement(\"p\",null,\"You only scored \".concat(player1Score,\" points.\")));}if(playerMode===1&&player1Score>25&&player1Score<=50){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"You are not too bad at this!\"),/*#__PURE__*/React.createElement(\"p\",null,\"You scored \".concat(player1Score,\" points.\")));}if(playerMode===1&&player1Score>50){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"You have acheived greatness!\"),/*#__PURE__*/React.createElement(\"p\",null,\"You scored \".concat(player1Score,\" points.\")));}// 2 Player Mode\nif(playerMode===2&&player1Score===player2Score){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Wow!\"),/*#__PURE__*/React.createElement(\"h2\",null,\"It's a draw.\"),/*#__PURE__*/React.createElement(\"p\",null,\"You both scored \".concat(player1Score,\" points.\")));}if(playerMode===2&&player1Score>player2Score){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,nameForPlayer1),/*#__PURE__*/React.createElement(\"h2\",null,\"wins the game!!\"),/*#__PURE__*/React.createElement(\"p\",null,\"\".concat(nameForPlayer2,\" is a loser\"),/*#__PURE__*/React.createElement(\"br\",null),\"and has been\",/*#__PURE__*/React.createElement(\"br\",null),\"beaten by \".concat(player1Score-player2Score),\" \",player1Score-player2Score===1?\"point.\":\"points.\"));}if(playerMode===2&&player1Score<player2Score){endOfGameMessage=/*#__PURE__*/React.createElement(\"div\",{className:\"farewell-message\"},/*#__PURE__*/React.createElement(\"h1\",null,nameForPlayer2),/*#__PURE__*/React.createElement(\"h2\",null,\"wins the game!!\"),/*#__PURE__*/React.createElement(\"p\",null,\"\".concat(nameForPlayer1,\" is a loser\"),/*#__PURE__*/React.createElement(\"br\",null),\"and has been\",/*#__PURE__*/React.createElement(\"br\",null),\"beaten by \".concat(player2Score-player1Score),\" \",player2Score-player1Score===1?\"point.\":\"points.\"));}console.log(\"Who scored high:\",isHighScore);return/*#__PURE__*/React.createElement(\"div\",{id:\"end-game\"},endOfGameMessage,isHighScore.length===1?/*#__PURE__*/React.createElement(\"div\",{className:\"top-scorer\"},/*#__PURE__*/React.createElement(\"img\",{className:\"trophy\",src:\"card-svgs/award.svg\",alt:\"\"}),/*#__PURE__*/React.createElement(\"h3\",{className:\"top-score-message\"},\"Congrats \".concat(isHighScore[0].name,\"!!\"),/*#__PURE__*/React.createElement(\"br\",null),\"You scored in the top ten!\")):null,isHighScore.length===2?/*#__PURE__*/React.createElement(\"div\",{className:\"top-scorer\"},/*#__PURE__*/React.createElement(\"img\",{className:\"trophy\",src:\"card-svgs/award.svg\",alt:\"\"}),/*#__PURE__*/React.createElement(\"h3\",{className:\"top-score-message\"},\"Congratulations...\",/*#__PURE__*/React.createElement(\"br\",null),\"\".concat(isHighScore[0].name,\" and \").concat(isHighScore[1].name,\",\"),/*#__PURE__*/React.createElement(\"br\",null),\"both of you scored\",/*#__PURE__*/React.createElement(\"br\",null),\"in the top ten!\")):null,/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return restart();}},\"Play Again?\"));}","map":{"version":3,"sources":["/Users/meghangosselin/Apps/thinkfast/src/components/EndGame.js"],"names":["React","useState","useEffect","axios","Howl","EndGame","setIsEnd","playerMode","setPlayerMode","nameForPlayer1","nameForPlayer2","player1Score","setPlayer1Score","player2Score","setPlayer2Score","highScores","setHighScores","getAndSetHighScores","isHighScore","setIsHighScore","trophy","src","volume","end","eliminateScorerFromTopTen","scorerId","delete","then","response","console","log","catch","error","postHighScoreToTopTen","player","post","name","score","date","determineScoresToPost","p1","p2","tempScores","slice","sort","a","b","topTen","whoMadeTheTopTen","filter","hasOwnProperty","play","postScores","_id","scores","forEach","length","getTheDate","today","Date","month","String","getMonth","year","getFullYear","restart","endOfGameMessage"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Howl } from \"howler\";\r\n\r\nimport \"../styles/EndGame.scss\";\r\n\r\nexport default function EndGame({\r\n  setIsEnd,\r\n  playerMode,\r\n  setPlayerMode,\r\n  nameForPlayer1,\r\n  nameForPlayer2,\r\n  player1Score,\r\n  setPlayer1Score,\r\n  player2Score,\r\n  setPlayer2Score,\r\n  highScores,\r\n  setHighScores,\r\n  getAndSetHighScores,\r\n}) {\r\n  const [isHighScore, setIsHighScore] = useState([]); // When true will notify of new high score\r\n\r\n  // End of game sound\r\n  let trophy = new Howl({\r\n    src: [\"audio/trophy.mp3\"],\r\n    volume: 0.3,\r\n  });\r\n\r\n  let end = new Howl({\r\n    src: [\"audio/game-end.mp3\"],\r\n    volume: 0.2,\r\n  });\r\n\r\n  // API REQUEST FUNCTIONS\r\n  const eliminateScorerFromTopTen = (scorerId) => {\r\n    axios\r\n      .delete(`https://thinkfast-api.herokuapp.com/scores/${scorerId}`)\r\n      .then(function (response) {\r\n        console.log(`${scorerId} has been deleted`);\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  const postHighScoreToTopTen = (player) => {\r\n    axios\r\n      .post(\"https://thinkfast-api.herokuapp.com/scores\", {\r\n        name: player.name,\r\n        score: player.score,\r\n        date: player.date,\r\n      })\r\n      .then(function (response) {\r\n        console.log(`High score posted for ${player.name}`);\r\n        getAndSetHighScores(setHighScores);\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  // FUNCTIONS DEALING WITH HIGH SCORES\r\n  // If in 2-player mode and both score higher than the current 10th place score this will determine what scores will get posted and eliminated\r\n  const determineScoresToPost = (p1, p2) => {\r\n    let tempScores = highScores.slice();\r\n    tempScores = [...tempScores, p1, p2];\r\n    tempScores.sort((a, b) => b.score - a.score);\r\n    let topTen = tempScores.slice(0, 10);\r\n    let whoMadeTheTopTen = topTen.filter(\r\n      (score) => !score.hasOwnProperty(\"_id\")\r\n    );\r\n\r\n    setIsHighScore([...whoMadeTheTopTen]);\r\n    trophy.play();\r\n\r\n    if (postScores(whoMadeTheTopTen) === 2) {\r\n      console.log(\"Delete:\", tempScores[10], tempScores[11]);\r\n      eliminateScorerFromTopTen(tempScores[10]._id);\r\n      eliminateScorerFromTopTen(tempScores[11]._id);\r\n    } else {\r\n      console.log(\"Delete:\", tempScores[11]);\r\n      eliminateScorerFromTopTen(tempScores[11]._id);\r\n    }\r\n  };\r\n\r\n  const postScores = (scores) => {\r\n    scores.forEach((score) => {\r\n      postHighScoreToTopTen(score);\r\n    });\r\n    return scores.length;\r\n  };\r\n\r\n  /////////////////////////////////////////////////////////////////////////////////\r\n\r\n  useEffect(() => {\r\n    // Play ending music\r\n    end.play();\r\n\r\n    // Get today's date and return as formatted string \"m/yy\"\r\n    const getTheDate = () => {\r\n      let today = new Date();\r\n      let month = String(today.getMonth() + 1);\r\n      let year = String(today.getFullYear()).slice(-2);\r\n      return `${month}/${year}`;\r\n    };\r\n\r\n    // Create object for player 1\r\n    const p1 = {\r\n      name: nameForPlayer1,\r\n      score: player1Score,\r\n      date: getTheDate(),\r\n    };\r\n\r\n    // Create object for player 2\r\n    const p2 = {\r\n      name: nameForPlayer2,\r\n      score: player2Score,\r\n      date: getTheDate(),\r\n    };\r\n\r\n    // First, in a 2-player game, determine if both players score high enough to be in top 10.\r\n    // Second, in either a single or 2-player game check if player 1 scored high enough.\r\n    // Third, check if player 2 scored high enough\r\n    if (\r\n      playerMode === 2 &&\r\n      player1Score > highScores[9].score &&\r\n      player2Score > highScores[9].score\r\n    ) {\r\n      determineScoresToPost(p1, p2);\r\n    } else if (player1Score > highScores[9].score) {\r\n      eliminateScorerFromTopTen(highScores[9]._id);\r\n      postHighScoreToTopTen(p1);\r\n      setIsHighScore([p1]);\r\n      trophy.play();\r\n    } else if (player2Score > highScores[9].score) {\r\n      eliminateScorerFromTopTen(highScores[9]._id);\r\n      postHighScoreToTopTen(p2);\r\n      setIsHighScore([p2]);\r\n      trophy.play();\r\n    }\r\n  }, [nameForPlayer1]);\r\n\r\n  //////////////////////////////////////////////////////////////////\r\n\r\n  const restart = () => {\r\n    setIsEnd(false);\r\n    setPlayer1Score(0);\r\n    setPlayer2Score(0);\r\n    setIsHighScore([]);\r\n    setPlayerMode(null);\r\n  };\r\n\r\n  // MESSAGING FOR END OF GAME (DEPENDS ON PLAYER MODE AND PLAYER'S SCORE)\r\n  let endOfGameMessage;\r\n\r\n  // 1 Player Mode\r\n  if (playerMode === 1 && player1Score < 0) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>You are such a negative person!</h1>\r\n        <p>{`You scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 1 && player1Score === 0) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>You thought you were a hero, but then got zero!</h1>\r\n        <p>{`You scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 1 && player1Score > 0 && player1Score <= 25) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>You need a lot more practice!</h1>\r\n        <p>{`You only scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 1 && player1Score > 25 && player1Score <= 50) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>You are not too bad at this!</h1>\r\n        <p>{`You scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 1 && player1Score > 50) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>You have acheived greatness!</h1>\r\n        <p>{`You scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 2 Player Mode\r\n  if (playerMode === 2 && player1Score === player2Score) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>Wow!</h1>\r\n        <h2>It's a draw.</h2>\r\n        <p>{`You both scored ${player1Score} points.`}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 2 && player1Score > player2Score) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>{nameForPlayer1}</h1>\r\n        <h2>wins the game!!</h2>\r\n        <p>\r\n          {`${nameForPlayer2} is a loser`}\r\n          <br />\r\n          {`and has been`}\r\n          <br />\r\n          {`beaten by ${player1Score - player2Score}`}{\" \"}\r\n          {player1Score - player2Score === 1 ? \"point.\" : \"points.\"}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (playerMode === 2 && player1Score < player2Score) {\r\n    endOfGameMessage = (\r\n      <div className=\"farewell-message\">\r\n        <h1>{nameForPlayer2}</h1>\r\n        <h2>wins the game!!</h2>\r\n        <p>\r\n          {`${nameForPlayer1} is a loser`}\r\n          <br />\r\n          {`and has been`}\r\n          <br />\r\n          {`beaten by ${player2Score - player1Score}`}{\" \"}\r\n          {player2Score - player1Score === 1 ? \"point.\" : \"points.\"}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  console.log(\"Who scored high:\", isHighScore);\r\n  return (\r\n    <div id=\"end-game\">\r\n      {endOfGameMessage}\r\n      {isHighScore.length === 1 ? (\r\n        <div className=\"top-scorer\">\r\n          <img className=\"trophy\" src=\"card-svgs/award.svg\" alt=\"\" />\r\n          <h3 className=\"top-score-message\">\r\n            {`Congrats ${isHighScore[0].name}!!`}\r\n            <br />\r\n            {`You scored in the top ten!`}\r\n          </h3>\r\n        </div>\r\n      ) : null}\r\n\r\n      {isHighScore.length === 2 ? (\r\n        <div className=\"top-scorer\">\r\n          <img className=\"trophy\" src=\"card-svgs/award.svg\" alt=\"\" />\r\n          <h3 className=\"top-score-message\">\r\n            {`Congratulations...`}\r\n            <br />\r\n            {`${isHighScore[0].name} and ${isHighScore[1].name},`}\r\n            <br />\r\n            {`both of you scored`}\r\n            <br />\r\n            {`in the top ten!`}\r\n          </h3>\r\n        </div>\r\n      ) : null}\r\n\r\n      <button onClick={() => restart()}>Play Again?</button>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}